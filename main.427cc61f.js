(()=>{"use strict";const e=[[["","Backquote","ё","Ё","`","~"],["","Digit1","1","!","1","!"],["","Digit2","2",'"',"2","@"],["","Digit3","3","№","3","#"],["","Digit4","4",";","4","$"],["","Digit5","5","%","5","%"],["","Digit6","6",":","6","^"],["","Digit7","7","?","7","&"],["","Digit8","8","*","8","*"],["","Digit9","9","(","9","("],["","Digit0","0",")","0",")"],["","Minus","-","_","-","_"],["","Equal","=","+","=","+"],["backspace","Backspace","Backspace","Backspace","Backspace","Backspace"]],[["tab","Tab","Tab","Tab","Tab","Tab"],["","KeyQ","й","Й","q","Q"],["","KeyW","ц","Ц","w","W"],["","KeyE","у","У","e","E"],["","KeyR","к","К","r","R"],["","KeyT","е","Е","t","T"],["","KeyY","н","Н","y","Y"],["","KeyU","г","Г","u","U"],["","KeyI","ш","Ш","i","I"],["","KeyO","щ","Щ","o","O"],["","KeyP","з","З","p","P"],["","BracketLeft","х","Х","[","{"],["","BracketRight","ъ","Ъ","]","}"],["","Backslash","\\","/","\\","|"],["del","Delete","Del","Del","Del","Del","Del"]],[["capslock","CapsLock","CapsLock","CapsLock","CapsLock","CapsLock","CapsLock"],["","KeyA","ф","Ф","a","A"],["","KeyS","ы","Ы","s","S"],["","KeyD","в","В","d","D"],["","KeyF","а","А","f","F"],["","KeyG","п","П","g","G"],["","KeyH","р","Р","h","H"],["","KeyJ","о","О","j","J"],["","KeyK","л","Л","k","K"],["","KeyL","д","Д","l","L"],["","Semicolon","ж","Ж",";",":"],["","Quote","э","Э","'",'"'],["enter","Enter","Enter","Enter","Enter","Enter"]],[["shift-left","ShiftLeft","Shift","Shift","Shift","Shift"],["","KeyZ","я","Я","z","Z"],["","KeyX","ч","Ч","x","X"],["","KeyC","с","С","c","C"],["","KeyV","м","М","v","V"],["","KeyB","и","И","b","B"],["","KeyN","т","Т","n","N"],["","KeyM","ь","Ь","m","M"],["","Comma","б","Б",".","<"],["","Period","ю","Ю",",",">"],["","Slash",".",",","/","?"],["arrow","ArrowUp","↑","↑","↑","↑"],["shift-right","ShiftRight","Shift","Shift","Shift","Shift"]],[["ctrl-left","ControlLeft","Ctrl","Ctrl","Ctrl","Ctrl"],["win","MetaLeft","Win","Win","Win","Win"],["alt-left","AltLeft","Alt","Alt","Alt","Alt"],["space","Space"," "," "," "," "],["alt-right","AltRight","Alt","Alt","Alt","Alt"],["arrow","ArrowLeft","←","←","←","←"],["arrow","ArrowDown","↓","↓","↓","↓"],["arrow","ArrowRight","→","→","→","→"],["ctrl-right","ControlRight","Ctrl","Ctrl","Ctrl","Ctrl"]]];const t=new class{constructor(){this.isShiftPress=!1,this.isAltLeftPress=!1,this.isAltRightPress=!1,this.isCtrlLeftPress=!1,this.isCtrlRightPress=!1,this.symbol="",this.keyboard=document.createElement("div"),this.textArea=document.createElement("textarea"),this.pageLangBtn=document.createElement("button")}createMainElements(){null===localStorage.getItem("virtualKeyboardLang")&&localStorage.setItem("virtualKeyboardLang","EN");const e=document.createElement("div");e.className="wrapper",document.body.append(e),this.pageLangBtn.className="page-lang",e.append(this.pageLangBtn),this.pageLangBtn.insertAdjacentText("afterbegin","blabla"),this.pageLangBtn.innerText=localStorage.getItem("virtualKeyboardLang"),this.textArea.className="textarea",e.append(this.textArea),this.textArea.setAttribute("type","textarea"),this.textArea.focus(),this.keyboard.className="keyboard",e.append(this.keyboard),this.notice=document.createElement("p"),this.notice.innerText="Toggle language: Left Alt + Left Shift. Designed for Windows",e.append(this.notice)}createButtons(){const t=[14,15,13,13,9];for(let s=0;s<5;s+=1){const a=document.createElement("div");a.className="row",this.keyboard.append(a);for(let i=0;i<t[s];i+=1){const t=document.createElement("button");t.className="key ".concat(e[s][i][0]),a.append(t);const r=document.createElement("span"),o=document.createElement("span"),n=document.createElement("span"),l=document.createElement("span"),c=document.createElement("span"),h=document.createElement("span");let[g,d]=[" on"," off"];"EN"===localStorage.getItem("virtualKeyboardLang")?(g=" on",d=" off"):(g=" off",d=" on"),r.className=e[s][i][1]+g,l.className=e[s][i][1]+d,t.append(r),t.append(l),h.className="case-shown",l.append(h),h.insertAdjacentText("afterbegin",e[s][i][2]),c.className="case-hidden",l.append(c),c.insertAdjacentText("afterbegin",e[s][i][3]),n.className="case-shown",r.append(n),n.insertAdjacentText("afterbegin",e[s][i][4]),o.className="case-hidden",r.append(o),o.insertAdjacentText("afterbegin",e[s][i][5])}}}caseUp(){this.isShiftPress=!0,document.querySelectorAll(".on").forEach((e=>{e.children[0].classList.remove("case-shown"),e.children[0].classList.add("case-hidden"),e.children[1].classList.add("case-shown"),e.children[1].classList.remove("case-hidden")}))}caseDown(){this.isShiftPress=!1,document.querySelectorAll(".on").forEach((e=>{e.children[0].classList.add("case-shown"),e.children[0].classList.remove("case-hidden"),e.children[1].classList.remove("case-shown"),e.children[1].classList.add("case-hidden")}))}setCaretPosition(e){if(this.textArea.setSelectionRange)this.textArea.focus(),this.textArea.setSelectionRange(e,e);else if(this.textArea.createTextRange){const t=this.textArea.createTextRange();t.collapse(!0),t.moveEnd("",e),t.moveStart("",e),t.select()}}activeBtnHighlighting(e){this.isShiftPress?(this.isShiftPress=!0,e.classList.add("active")):(this.isShiftPress=!1,e.classList.remove("active"))}pageLangChanging(){"EN"===localStorage.getItem("virtualKeyboardLang")?(localStorage.removeItem("virtualKeyboardLang"),localStorage.setItem("virtualKeyboardLang","RU")):"RU"===localStorage.getItem("virtualKeyboardLang")&&(localStorage.removeItem("virtualKeyboardLang"),localStorage.setItem("virtualKeyboardLang","EN")),this.pageLangBtn.innerText=localStorage.getItem("virtualKeyboardLang"),this.keyboard.querySelectorAll(".row").forEach((e=>{e.querySelectorAll(".key").forEach((e=>{const t=e.querySelector(".on"),s=e.querySelector(".off");t.classList.remove("on"),t.classList.add("off"),s.classList.remove("off"),s.classList.add("on")}))}))}symbolChoise(e){const[,,t,s,a,i]=e;"RU"===localStorage.getItem("virtualKeyboardLang")&&this.isShiftPress?this.symbol=s:"RU"!==localStorage.getItem("virtualKeyboardLang")||this.isShiftPress?"EN"===localStorage.getItem("virtualKeyboardLang")&&this.isShiftPress?this.symbol=i:"EN"!==localStorage.getItem("virtualKeyboardLang")||this.isShiftPress||(this.symbol=a):this.symbol=t}printingInTextArea(t){this.symbol="";const s=t.target.closest("button");if(s){const t=s.querySelector(".on").className.split(" ")[0],a=s.classList[1];if(e.forEach((e=>{e.forEach((e=>{e[1]!==t||void 0!==a&&"space"!==a&&"tab"!==a&&"enter"!==a||this.symbolChoise(e)}))})),"tab"===a&&(this.symbol="  "),"enter"===a&&(this.symbol="\n"),this.textArea.setRangeText(this.symbol,this.textArea.selectionStart,this.textArea.selectionEnd,"end"),"backspace"===a&&this.textArea.selectionStart>0){const e=this.textArea.selectionStart;this.textArea.value=this.textArea.value.slice(0,e-1)+this.textArea.value.slice(e,this.textArea.value.length),this.textArea.setRangeText("",e-1,e-1,"end")}if("del"===a){const e=this.textArea.selectionStart;this.textArea.selectionStart<=this.textArea.value.length&&(this.textArea.value=this.textArea.value.slice(0,e)+this.textArea.value.slice(e,this.textArea.value.length),this.textArea.setRangeText("",e,e+1,"end"))}const i=document.querySelector(".".concat(a));if("shift-left"!==a&&"shift-right"!==a&&"capslock"!==a||(this.isShiftPress?(i.classList.remove("active"),this.caseDown()):(i.classList.add("active"),this.caseUp())),"arrow"===a){const e=this.textArea.selectionStart;"ArrowUp"===t?this.setCaretPosition(e-70):"ArrowRight"===t?this.setCaretPosition(e+1):"ArrowDown"===t?this.setCaretPosition(e+70):"ArrowLeft"===t&&this.textArea.selectionStart>0&&this.setCaretPosition(e-1)}"alt-left"===a&&(this.isAltLeftPress=this.activeBtnHighlighting(this.isAltLeftPress,i)),"alt-right"===a&&(this.isAltRightPress=this.activeBtnHighlighting(this.isAltRightPress,i)),"ctrl-left"===a&&(this.isCtrlLeftPress=this.activeBtnHighlighting(this.isCtrlLeftPress,i)),"ctrl-right"===a&&(this.isCtrlRightPress=this.activeBtnHighlighting(this.isCtrlRightPress,i))}this.textArea.focus()}keyDownOnRealKeyboard(t){t.shiftKey&&this.caseUp(),t.shiftKey&&t.altKey&&this.pageLangChanging(),this.textArea.focus(),this.symbol="",e.forEach((e=>{e.forEach((e=>{e[1]===t.code&&"Backspace"!==t.key&&"Delete"!==t.key&&"CapsLock"!==t.key&&"Shift"!==t.key&&"Control"!==t.key&&"Meta"!==t.key&&"Enter"!==t.key&&"Alt"!==t.key&&"Tab"!==t.key&&"ArrowUp"!==t.key&&"ArrowRight"!==t.key&&"ArrowDown"!==t.key&&"ArrowLeft"!==t.key&&(t.preventDefault(),this.symbolChoise(e))}))})),this.textArea.setRangeText(this.symbol,this.textArea.selectionStart,this.textArea.selectionEnd,"end"),this.keyboard.querySelectorAll(".row").forEach((e=>{e.querySelectorAll(".key").forEach((e=>{t.code===e.children[0].classList[0]&&("CapsLock"===t.key?e.classList.contains("active")?(e.classList.remove("active"),this.caseDown(),this.isShiftPress=!1):(e.classList.add("active"),this.caseUp(),this.isShiftPress=!0):e.classList.add("active"))}))}))}keyUpOnRealKeyboard(e){this.caseDown(),this.keyboard.querySelectorAll(".row").forEach((t=>{t.querySelectorAll(".key").forEach((t=>{e.code===t.children[0].classList[0]&&"CapsLock"!==e.key&&t.classList.remove("active")}))}))}};t.createMainElements(),t.createButtons(),document.addEventListener("click",(e=>{e.target.classList.contains("page-lang")?t.pageLangChanging(e):t.printingInTextArea(e)})),document.addEventListener("keydown",(e=>{t.keyDownOnRealKeyboard(e)})),document.addEventListener("keyup",(e=>{t.keyUpOnRealKeyboard(e)})),window.onbeforeunload=()=>"Есть несохранённые изменения. Всё равно уходим?"})();